<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MVP Test Runner</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üöÄ MVP Test Runner</h1>
    <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π MVP, –≤–∫–ª—é—á–∞—è Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
    
    <button onclick="runTest()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
    <button onclick="clearLogs()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
    
    <div id="logs"></div>

    <script type="module">
        import { sendTelegramNotification } from './src/services/telegramNotify.js';
        
        const logsDiv = document.getElementById('logs');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            logsDiv.appendChild(div);
            console.log(message);
        }
        
        window.clearLogs = () => {
            logsDiv.innerHTML = '';
        };
        
        window.runTest = async () => {
            log('üöÄ –ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è MVP...', 'info');
            
            try {
                // –¢–µ—Å—Ç 1: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏
                log('1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è "–ù–æ–≤–∞—è –≤–∞–∫–∞–Ω—Å–∏—è"...', 'info');
                await sendTelegramNotification('763612632', 'üìã –ù–æ–≤–∞—è –≤–∞–∫–∞–Ω—Å–∏—è: –¢–µ—Å—Ç–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è (MVP Test)');
                log('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤–∞–∫–∞–Ω—Å–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ', 'success');
                
                // –ü–∞—É–∑–∞ –º–µ–∂–¥—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // –¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–µ–π–¥–∂–µ
                log('2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è "–ü–æ–ª—É—á–µ–Ω –±–µ–π–¥–∂"...', 'info');
                await sendTelegramNotification('763612632', 'üèÖ –í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–µ–π–¥–∂: –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏! (MVP Test)');
                log('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –±–µ–π–¥–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ', 'success');
                
                // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞
                log('3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞...', 'info');
                
                // –°–∏–º—É–ª—è—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏
                const mockJob = {
                    id: Date.now(),
                    title: '–¢–µ—Å—Ç–æ–≤–∞—è –≤–∞–∫–∞–Ω—Å–∏—è MVP',
                    description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞',
                    created_at: new Date().toISOString()
                };
                log(`‚úÖ –î–µ–º–æ-–≤–∞–∫–∞–Ω—Å–∏—è —Å–æ–∑–¥–∞–Ω–∞: ${mockJob.title}`, 'success');
                
                // –°–∏–º—É–ª—è—Ü–∏—è –≤—ã–¥–∞—á–∏ –±–µ–π–¥–∂–∞
                const mockBadge = {
                    id: Date.now(),
                    badge_name: '–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏',
                    reason: 'MVP —Ç–µ—Å—Ç',
                    awarded_at: new Date().toISOString()
                };
                log(`‚úÖ –î–µ–º–æ-–±–µ–π–¥–∂ –≤—ã–¥–∞–Ω: ${mockBadge.badge_name}`, 'success');
                
                // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
                log('4. –ü—Ä–æ–≤–µ—Ä–∫–∞ PWA –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏...', 'info');
                if ('serviceWorker' in navigator) {
                    log('‚úÖ Service Worker –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'success');
                } else {
                    log('‚ö†Ô∏è Service Worker –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'error');
                }
                
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ PWA —Ä–µ–∂–∏–º–µ', 'success');
                } else {
                    log('‚ÑπÔ∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–Ω–µ PWA)', 'info');
                }
                
                log('üéâ –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π MVP –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                log('üì± –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram', 'info');
                log('üìã –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ MVP —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏: ${error.message}`, 'error');
                console.error('–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', error);
            }
        };
    </script>
</body>
</html>
