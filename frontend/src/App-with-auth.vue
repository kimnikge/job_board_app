<template>
  <div id="app">
    <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏–ª–∏ –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <component :is="currentComponent" />
  </div>
</template>

<script>
import { ref, onMounted } from 'vue'
import AuthPage from './components/AuthPage.vue'
import MainPage from './components/MainPage.vue'

export default {
  name: 'App',
  components: {
    AuthPage,
    MainPage
  },
  setup() {
    const currentComponent = ref('AuthPage')
    const isAuthenticated = ref(false)
    
    onMounted(() => {
      try {
        console.log('üöÄ App —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π')
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        checkAuth()
        
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:', error)
      }
    })
    
    const checkAuth = () => {
      try {
        // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        const savedUser = localStorage.getItem('telegram_user')
        if (savedUser) {
          isAuthenticated.value = true
          currentComponent.value = 'MainPage'
          console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω')
        } else {
          currentComponent.value = 'AuthPage'
          console.log('üîë –ù—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è')
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error)
        currentComponent.value = 'AuthPage'
      }
    }

    return {
      currentComponent
    }
  }
}
</script>

<style>
#app {
  min-height: 100vh;
  background: #1a1a2e;
  color: white;
  font-family: Arial, sans-serif;
}
</style>
